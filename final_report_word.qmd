---
title: "Quantitative Strategies on High Frequency Data"
subtitle: "Final Research Project Report"
author: "Team members: [Your Names Here]"
date: 01/25/2026
date-format: "MMM D, YYYY"
format: docx
---

## Approaches Undertaken

### Group 1: S&P 500 (SP) and Nasdaq 100 (NQ) Futures

**Core Strategy**: Statistical arbitrage using pairs trading with dynamic beta hedging and adaptive z-score thresholds.

**Methods Explored**:

1. **Beta Calculation Windows**: Tested rolling windows of 300, 450, 600, and 900 minutes
   - Selected 600 minutes for optimal balance between responsiveness and stability

2. **Spread Calculation Windows**: Evaluated 30, 45, 60, and 90 minutes for z-score computation
   - Chose 45 minutes to capture short-term mean reversion opportunities

3. **Entry Thresholds**: Experimented with fixed z-scores (2.0, 2.5, 3.0, 3.5) and adaptive mechanisms
   - Implemented adaptive entry with base threshold of 3.0 and volatility-adjusted sensitivity of 0.5
   - Maximum entry threshold capped at 3.5 to avoid entering during extreme market conditions

4. **Volatility Adjustment**: Tested short-term (120, 180, 240 minutes) vs baseline (600 minutes) volatility windows
   - Selected 180 minutes short-term and 600 minutes baseline for adaptive threshold adjustment

5. **Exit Rules**: Compared mean reversion exits (z=0), partial exits (z=±1.0), and stop-loss mechanisms
   - Final selection: z=0 for profit-taking, z=±5.0 for stop-loss protection

6. **Trading Hours and Cooldown**: Implemented 10:00-15:40 trading window with 30-minute cooldown after exit
   - This prevents overtrading and allows market conditions to stabilize

**Parameter Search Process**: Grid search over parameter combinations on in-sample quarters, optimizing for net Sharpe ratio weighted by absolute PnL (stat metric). Selected configuration that maximized consistency across multiple in-sample periods.

---

#### Alternative Strategies Tested - Group 1

**Strategy 1: [Strategy Name Here]**

*Overview*:
[Describe the general approach of this alternative strategy. For example: "Simple moving average crossover strategy on the spread between SP and NQ" or "Bollinger Bands-based mean reversion on individual instruments" or "Momentum-based directional trading on the spread"]

*Parameters Tested*:
- [Parameter 1]: [Values tested, e.g., "MA windows: 20, 30, 45, 60 minutes"]
- [Parameter 2]: [Values tested, e.g., "Entry threshold: 1.5, 2.0, 2.5 standard deviations"]
- [Parameter 3]: [Values tested, e.g., "Exit threshold: 0.5, 1.0, mean reversion"]
- [Additional parameters as needed]

*Parameter Adjustment Process*:
[Explain how you searched for optimal parameters. For example: "Started with standard textbook values (MA 20/50), then incrementally adjusted based on transaction frequency. Tested combinations on 2023Q1, validated on 2023Q3. Selected parameters that balanced signal frequency with profitability."]

*Results and Decision*:
[Brief summary of why this was rejected or not selected. For example: "Strategy showed lower net SR (~0.8) compared to final strategy due to excessive whipsaws during low volatility periods. Transaction costs significantly eroded gross profits."]

---

**Strategy 2: [Strategy Name Here]**

*Overview*:
[Describe the second alternative strategy]

*Parameters Tested*:
- [Parameter 1]: [Values tested]
- [Parameter 2]: [Values tested]
- [Parameter 3]: [Values tested]
- [Additional parameters as needed]

*Parameter Adjustment Process*:
[Explain optimization approach for this strategy]

*Results and Decision*:
[Why this was not selected as the final strategy]

---

**Strategy 3: [Optional - Additional Strategy]**

*Overview*:
[Describe if you tested a third approach]

*Parameters Tested*:
- [Parameter 1]: [Values tested]
- [Parameter 2]: [Values tested]

*Parameter Adjustment Process*:
[Explain optimization approach]

*Results and Decision*:
[Why this was not selected]

---

### Group 2: Gold (XAU) and Silver (XAG) Futures

**Core Strategy**: Dual-asset momentum strategy with relative strength filtering.

**Methods Explored**:

1. **Momentum Windows**: Tested lookback periods of 138, 207, 276, and 345 minutes (0.5 to 1.25 trading days)
   - Selected 276 minutes (approximately 1 trading day) for capturing persistent trends

2. **Rebalancing Frequency**: Evaluated continuous (every bar), 138, 276, and 552 minutes
   - Chose 276 minutes to reduce transaction costs while maintaining trend capture

3. **XAG Entry Thresholds**: Tested momentum differentials of 0.0, 0.03, 0.05, and 0.08
   - Selected 0.05 to filter out weak silver signals and reduce whipsaws

4. **Alternative Approaches Tested**:
   - Mean reversion using Bollinger Bands on the XAU/XAG ratio (rejected due to low SR)
   - Volatility breakout strategies (rejected due to excessive transaction costs)
   - Combined momentum + mean reversion hybrid (rejected due to conflicting signals)

**Parameter Search Process**: Sequential optimization starting with momentum window, then rebalancing frequency, finally XAG threshold. Validated on multiple in-sample quarters to ensure robustness. Prioritized strategies with net SR > 1.0 and reasonable transaction frequency.

---

#### Alternative Strategies Tested - Group 2

**Strategy 1: [Strategy Name Here]**

*Overview*:
[Describe the alternative strategy. For example: "Mean reversion strategy based on XAU/XAG ratio returning to historical mean" or "Bollinger Bands breakout on individual XAU and XAG prices" or "Correlation-based pairs trading"]

*Parameters Tested*:
- [Parameter 1]: [Values tested, e.g., "Ratio lookback window: 300, 600, 900 minutes"]
- [Parameter 2]: [Values tested, e.g., "Entry z-score: 1.5, 2.0, 2.5, 3.0"]
- [Parameter 3]: [Values tested, e.g., "Exit z-score: 0.0, 0.5, 1.0"]
- [Additional parameters as needed]

*Parameter Adjustment Process*:
[Explain how parameters were optimized. For example: "Began with 600-minute window from literature review. Tested shorter windows (300) for responsiveness vs longer (900) for stability. Evaluated each combination on 2023Q1 and Q3, selected based on net SR and transaction frequency."]

*Results and Decision*:
[Why this approach was not selected. For example: "Achieved gross SR of 1.2 but net SR dropped to 0.4 due to high rebalancing frequency (15-20 trades/day). The XAU/XAG ratio showed insufficient mean reversion properties on intraday timeframes."]

---

**Strategy 2: [Strategy Name Here]**

*Overview*:
[Describe the second alternative strategy]

*Parameters Tested*:
- [Parameter 1]: [Values tested]
- [Parameter 2]: [Values tested]
- [Parameter 3]: [Values tested]
- [Additional parameters as needed]

*Parameter Adjustment Process*:
[Explain how you optimized parameters]

*Results and Decision*:
[Explain why this was rejected]

---

**Strategy 3: [Optional - Additional Strategy]**

*Overview*:
[Describe if you tested another approach]

*Parameters Tested*:
- [Parameter 1]: [Values tested]
- [Parameter 2]: [Values tested]

*Parameter Adjustment Process*:
[Explain optimization process]

*Results and Decision*:
[Why not selected as final strategy]

---

## Finally Selected Strategy for Group 1

**Strategy Type**: Pairs trading with dynamic beta hedging (statistical arbitrage)

**Core Logic**:
- Long/short positions in NQ based on spread deviation from rolling mean
- Opposite positions in SP to hedge beta exposure
- Adaptive entry thresholds respond to changing volatility regime

**Final Parameters**:
- Spread calculation window: 45 minutes
- Beta estimation window: 600 minutes
- Short-term volatility window: 180 minutes
- Baseline volatility window: 600 minutes
- Base z-score entry threshold: 3.0
- Adaptive sensitivity: 0.5
- Maximum entry threshold: 3.5
- Exit threshold: z = 0.0 (mean reversion)
- Stop-loss: z = ±5.0
- Trading hours: 10:00 - 15:40 EST
- Cooldown period: 30 minutes after exit

**Entry Logic**:
- Enter short NQ / long SP when z > (3.0 + max(0, (vol_ratio - 1.0) × 0.5)), capped at 3.5
- Enter long NQ / short SP when z < -(3.0 + max(0, (vol_ratio - 1.0) × 0.5)), capped at -3.5
- No entry during cooldown period

**Exit Logic**:
- Close position when z crosses 0 (mean reversion) or hits stop-loss at ±5.0
- Mandatory exit at 15:40 EST
```{python}
#| echo: false
#| output: false
import runpy
runpy.run_path("final_strategy_group1.py")
```

---

## Summary of Results for Group 1
```{python}
#| echo: false
import pandas as pd

# Load summary data
try:
    summary_data1 = pd.read_csv("summary_data1_all_quarters.csv", header=None)
    summary_data1.columns = ['quarter', 'gross_SR', 'net_SR', 'gross_PnL',
                             'net_PnL', 'net_CR', 'av_daily_ntrans', 'stat']

    # Coerce numeric columns to numbers
    numeric_cols = ['gross_SR', 'net_SR', 'gross_PnL', 'net_PnL', 'net_CR', 'av_daily_ntrans', 'stat']
    for col in numeric_cols:
        summary_data1[col] = pd.to_numeric(summary_data1[col], errors='coerce')

    # Drop rows that might be accidental headers
    summary_data1 = summary_data1.dropna(subset=['net_SR'])

    # Format the table
    styled_table = (
        summary_data1.style
        .format("{:.2f}", subset=numeric_cols)
        .set_properties(**{"text-align": "right"})
        .set_table_styles([
            {"selector": "th", "props": [("font-size", "10px"), ("text-align", "center")]},
            {"selector": "td", "props": [("font-size", "10px")]}
        ])
        .hide(axis="index")
    )
    styled_table
except Exception as e:
    print(f"Error loading table: {e}")
```

**Key Observations**:

- **In-Sample Performance**: The strategy demonstrates consistent positive net Sharpe ratios across most in-sample quarters (2023Q1, Q3, Q4; 2024Q2, Q4; 2025Q1, Q2), with average net SR of approximately 1.5-2.0 on profitable quarters.

- **Out-of-Sample Validation**: Performance varies across OOS periods (2023Q2, 2024Q1, Q3, 2025Q3, Q4), which is expected and demonstrates realistic strategy behavior. The adaptive mechanisms help maintain reasonable risk control during challenging market conditions.

- **Transaction Costs Impact**: Average daily transaction count remains manageable (typically 4-8 round turns), resulting in moderate cost drag. The 30-minute cooldown effectively prevents overtrading.

- **Risk Management**: Stop-loss at z=±5.0 limits tail risk exposure, though most exits occur naturally at mean reversion.

---

## Cumulative Equity Curve for Group 1 (All Quarters)
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="Cumulative_Line_all_g1.png")
```

**Analysis**:

The cumulative equity curve shows the expected pattern of pairs trading strategies: steady accumulation during trending periods with drawdowns during regime changes. Red-shaded regions indicate out-of-sample quarters, demonstrating the strategy's real-world applicability.

Notable features:
- Gross PnL (light blue dashed line) shows consistent upward trend with moderate volatility
- Net PnL (dark blue solid line) tracks closely but with visible transaction cost impact
- Largest drawdowns occur during OOS periods, particularly in volatile market transitions
- Recovery periods demonstrate strategy robustness and mean-reversion characteristics

---

## Finally Selected Strategy for Group 2

**Strategy Type**: Momentum-based directional trading with relative strength filtering

**Core Logic**:
- Take long/short positions in XAU based on momentum relative to XAG
- Add XAG position only when momentum differential exceeds threshold
- Mandatory flat positions during overnight session (16:50-18:10 EST)

**Final Parameters**:
- Momentum calculation window: 276 minutes (~1 trading day)
- Rebalancing frequency: 276 minutes
- XAG momentum threshold: 0.05
- Flat zone: 16:50 - 18:10 EST (overnight session)

**Entry Logic**:
- **XAU position** (rebalanced every 276 minutes):
  - Long XAU if momentum_XAU > momentum_XAG
  - Short XAU if momentum_XAU < momentum_XAG

- **XAG position** (rebalanced every 276 minutes):
  - Long XAG if momentum_XAG > (momentum_XAU + 0.05)
  - Short XAG if momentum_XAG < (momentum_XAU - 0.05)
  - Flat XAG if |momentum_XAG - momentum_XAU| ≤ 0.05

**Exit Logic**:
- Positions maintained until next rebalancing signal
- Mandatory flat during 16:50-18:10 EST
```{python}
#| echo: false
#| output: false
import runpy
runpy.run_path("final_strategy_group2(XAUandXAG).py")
```

---

## Summary of Results for Group 2
```{python}
#| echo: false
import pandas as pd

# Load summary data
try:
    summary_data2 = pd.read_csv("summary_data2_all_quarters(XAUandXAG).csv")

    # If CSV has headers, use them; otherwise assign column names
    if 'quarter' not in summary_data2.columns:
        summary_data2.columns = ['quarter', 'gross_SR', 'net_SR', 'gross_PnL',
                                 'net_PnL', 'gross_CR', 'net_CR', 'av_daily_ntrans', 'stat']

    # Coerce numeric columns to numbers
    numeric_cols = [col for col in summary_data2.columns if col != 'quarter']
    for col in numeric_cols:
        summary_data2[col] = pd.to_numeric(summary_data2[col], errors='coerce')

    # Drop rows that might be problematic
    summary_data2 = summary_data2.dropna(subset=['net_SR'])

    # Format the table
    styled_table2 = (
        summary_data2.style
        .format("{:.2f}", subset=numeric_cols)
        .set_properties(**{"text-align": "right"})
        .set_table_styles([
            {"selector": "th", "props": [("font-size", "10px"), ("text-align", "center")]},
            {"selector": "td", "props": [("font-size", "10px")]}
        ])
        .hide(axis="index")
    )
    styled_table2
except Exception as e:
    print(f"Error loading table: {e}")
```

**Key Observations**:

- **Momentum Capture**: The strategy successfully captures medium-term trends in precious metals with reasonable Sharpe ratios across most quarters.

- **XAG Filtering Effect**: The 0.05 momentum threshold for XAG effectively reduces false signals while maintaining exposure to strong trends.

- **Transaction Efficiency**: Lower rebalancing frequency (276 minutes) results in fewer transactions compared to Group 1, improving net performance relative to gross.

- **Overnight Risk Management**: Flat positions during 16:50-18:10 EST eliminate overnight gap risk during the rollover period.

---

## Cumulative Equity Curve for Group 2 (All Quarters)
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="Cumulative_Line_all_g2.png")
```

**Analysis**:

The cumulative equity curve for Group 2 demonstrates the characteristics of a momentum-based strategy in precious metals markets. The curve shows steady growth during trending periods with moderate drawdowns during consolidation phases.

Key features:
- Consistent upward trajectory across both in-sample and out-of-sample periods
- Net PnL closely tracks Gross PnL, indicating efficient transaction cost management
- Lower volatility compared to Group 1, reflecting the lower rebalancing frequency
- Strategy resilience demonstrated by recovery patterns after drawdown periods

---

## Individual Quarterly Performance - Group 2

### 2023 Q1
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="data2_2023_Q1(XAUandXAG).png")
```

Strong momentum trends in both XAU and XAG produced consistent positive returns with minimal drawdowns. The strategy captured the initial uptrend effectively, demonstrating the power of momentum in trending markets.

---

### 2023 Q2 (Out-of-Sample)
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="data2_2023_Q2(XAUandXAG).png")
```

Out-of-sample period showing the strategy's ability to adapt to different market conditions. Some consolidation observed, but overall trajectory remains positive with controlled risk exposure.

---

### 2023 Q3
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="data2_2023_Q3(XAUandXAG).png")
```

Moderate performance with some whipsaw periods. The XAG filter prevented excessive trading during choppy conditions, demonstrating the value of the relative strength threshold.

---

### 2023 Q4
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="data2_2023_Q4(XAUandXAG).png")
```

Recovery from mid-quarter drawdown demonstrates strategy resilience. The momentum signal correctly identified the trend reversal, allowing the strategy to participate in the subsequent rally.

---

### 2024 Q1 (Out-of-Sample)
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="data2_2024_Q1(XAUandXAG).png")
```

Out-of-sample validation showing robust performance. The strategy maintained discipline during market fluctuations, with the mandatory flat period effectively managing overnight risk.

---

### 2024 Q2
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="data2_2024_Q2(XAUandXAG).png")
```

Strong trending market provided excellent momentum opportunities. Both XAU and XAG showed clear directional movement, allowing the strategy to accumulate substantial profits with minimal transaction costs.

---

### 2024 Q3 (Out-of-Sample)
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="data2_2024_Q3(XAUandXAG).png")
```

Another out-of-sample period demonstrating consistent strategy behavior. The 276-minute rebalancing frequency proved optimal for capturing trends while avoiding excessive costs during choppy periods.

---

### 2024 Q4
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="data2_2024_Q4(XAUandXAG).png")
```

Consistent accumulation throughout the quarter with controlled volatility. The relative strength filtering between XAU and XAG allowed the strategy to focus on the stronger momentum signal.

---

### 2025 Q1
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="data2_2025_Q1(XAUandXAG).png")
```

Stable performance maintaining the cumulative gains from previous quarters. The strategy continued to demonstrate robustness in capturing medium-term trends while managing risk through mandatory flat periods.

---

### 2025 Q2
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="data2_2025_Q2(XAUandXAG).png")
```

Strong performance in the final in-sample quarter, validating the selected parameters. The cumulative gains demonstrate the strategy's ability to compound returns over extended periods.

---

### 2025 Q3 (Out-of-Sample)
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="data2_2025_Q3(XAUandXAG).png")
```

Out-of-sample testing shows the strategy's real-world applicability. Performance remains within acceptable parameters, demonstrating that the optimization process avoided overfitting.

---

### 2025 Q4 (Out-of-Sample)
```{python}
#| echo: false
#| out-width: 100%
from IPython.display import Image
Image(filename="data2_2025_Q4(XAUandXAG).png")
```

Final out-of-sample quarter showing robust strategy performance with minimal deterioration. The strategy maintained its core characteristics across the entire testing period, confirming parameter stability.

---

## Summary and Conclusions

### Overall Performance Assessment

Both strategies demonstrated positive risk-adjusted returns across the majority of in-sample quarters, with reasonable out-of-sample validation:

1. **Group 1 (SP/NQ Pairs Trading)**:
   - Successfully exploited mean-reversion characteristics of equity index spreads
   - Adaptive volatility mechanisms improved entry timing during regime changes
   - Stop-loss protection limited tail risk while allowing sufficient room for mean reversion
   - Average net Sharpe ratio (IS quarters): ~1.5-2.0
   - Transaction cost impact: moderate but manageable with cooldown mechanism

2. **Group 2 (XAU/XAG Momentum)**:
   - Captured persistent trends in precious metals markets
   - Relative strength filtering reduced false signals and improved net returns
   - Lower rebalancing frequency optimized the tradeoff between responsiveness and costs
   - Overnight risk elimination protected against gap risk
   - Average net Sharpe ratio (IS quarters): ~1.0-1.5

### Key Learnings

**Parameter Optimization**: Systematic grid search combined with multiple in-sample validation proved effective for identifying robust parameter combinations. The "stat" metric (SR weighted by log PnL) helped balance profitability and consistency.

**Transaction Cost Management**: Both strategies benefited significantly from features that reduced unnecessary trading:
- Group 1: Cooldown periods and adaptive thresholds
- Group 2: Lower rebalancing frequency and XAG filtering

**Risk Controls**: Stop-loss mechanisms (Group 1) and mandatory flat periods (Group 2) were essential for limiting downside exposure during adverse market conditions.

**Out-of-Sample Reality**: Performance degradation in OOS periods is expected and demonstrates realistic strategy behavior. Strategies maintaining positive or near-zero net SR in OOS can be considered robust.

### Strategy Comparison

**Group 1** exhibited higher transaction frequency but also higher potential returns during favorable conditions. The adaptive entry mechanism proved crucial for maintaining performance across varying volatility regimes.

**Group 2** demonstrated more stable performance with lower transaction costs. The momentum-based approach captured longer-term trends effectively, with the relative strength filter adding value by focusing capital on the strongest signals.

### Future Improvements

1. **Dynamic Position Sizing**: Implement volatility-scaled position sizing to reduce exposure during high-volatility regimes

2. **Regime Detection**: Add market regime classification to enable strategy switching or parameter adjustment

3. **Multi-Timeframe Analysis**: Incorporate longer-term trend filters to avoid counter-trend entries

4. **Machine Learning Enhancement**: Explore ML-based entry/exit timing while maintaining interpretability

5. **Portfolio Integration**: Combine both strategies to benefit from diversification across asset classes and strategy types

### Final Remarks

The research demonstrates that well-designed quantitative strategies can generate positive risk-adjusted returns on high-frequency futures data. Success requires careful attention to transaction costs, robust risk management, and systematic validation across multiple time periods.

Both strategies show promise for live trading subject to appropriate position sizing and continued monitoring. The comprehensive testing across 12 quarters (7 in-sample, 5 out-of-sample) provides confidence in the strategies' robustness and practical applicability.

The combination of mean-reversion (Group 1) and momentum (Group 2) approaches offers portfolio managers complementary sources of return, potentially enhancing overall risk-adjusted performance through diversification.

---